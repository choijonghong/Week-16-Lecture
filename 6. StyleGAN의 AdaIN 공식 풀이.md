# **StyleGAN의 AdaIN 공식 풀이**

본 보고서는 StyleGAN(Style-based Generator Architecture for GANs)의 핵심 메커니즘인 \*\*AdaIN(Adaptive Instance Normalization)\*\*이 어떻게 이미지의 스타일(금발, 미소, 성별 등)을 결정하는지 수학적, 논리적으로 분석합니다.

## **1\. AdaIN 공식의 정의**

StyleGAN의 합성 네트워크(Synthesis Network) 각 레이어에서 스타일 $w$는 다음과 같은 **AdaIN** 연산을 통해 특징 맵(Feature Map) $x$에 주입됩니다.

$$AdaIN(x\_i, y) \= y\_{s,i} \\frac{x\_i \- \\mu(x\_i)}{\\sigma(x\_i)} \+ y\_{b,i}$$

* $x\_i$: 입력 특징 맵 (이미지의 구조적 정보)  
* $\\mu(x\_i), \\sigma(x\_i)$: 입력 특징 맵의 평균과 표준편차  
* $y\_{s,i}$: 스타일 스케일(Scale) 파라미터 (스타일 벡터 $w$로부터 선형 변환됨)  
* $y\_{b,i}$: 스타일 바이어스(Bias) 파라미터 (스타일 벡터 $w$로부터 선형 변환됨)

## **2\. 가상의 데이터를 통한 계산 시뮬레이션**

이해를 돕기 위해 특정 레이어의 특징 맵에 '머리카락 색상' 정보를 담은 3개의 데이터가 있다고 가정합니다.

### **\[Step 0\] 초기 상태 설정**

* **원본 데이터 (**$x$**):** $\[10, 20, 30\]$ (값이 낮을수록 어두운 '검은 머리' 특성)  
* **통계치:** 평균($\\mu$) \= $20$, 표준편차($\\sigma$) $\\approx 8.16$

### **\[Step 1\] 정규화 (Normalization): "기존 스타일 삭제"**

데이터의 평균을 $0$, 표준편차를 $1$로 만들어 원래 가지고 있던 스타일 정보를 제거합니다.

1. **중심화 (**$x \- \\mu$**):** $\[10-20, 20-20, 30-20\] \= \[-10, 0, 10\]$  
2. **척도화 (**$\\div \\sigma$**):** $\[-10/8.16, 0/8.16, 10/8.16\] \\approx \[-1.22, 0, 1.22\]$

**결과:** 이제 데이터는 평균 0, 표준편차 1인 '백지 상태'가 되었습니다. 형태(기울기) 정보만 남고 색상이나 밝기 정보는 사라졌습니다.

### **\[Step 2\] 스타일 입히기 (Styling): "새로운 스타일 주입"**

우리가 원하는 **'금발(Blonde)'** 스타일 파라미터가 다음과 같다고 가정합니다.

* **스타일 파라미터:** $y\_s \= 5.0$ (대비 강조), $y\_b \= 80.0$ (밝은 색조)  
1. **스케일 적용 (**$y\_s \\times \\hat{x}$**):** $\[5 \\times \-1.22, 5 \\times 0, 5 \\times 1.22\] \= \[-6.1, 0, 6.1\]$  
2. **바이어스 적용 (**$+ y\_b$**):** $\[-6.1+80, 0+80, 6.1+80\] \= \[73.9, 80, 86.1\]$

## **3\. 스타일 변화의 수학적 의미**

| 구분 | 원본 데이터 (x) | AdaIN 결과 (x′) | 변화의 의미 |
| :---- | :---- | :---- | :---- |
| **평균값** | $20$ (어두움) | $80$ (매우 밝음) | 전체적인 색조가 어두운 색에서 밝은 금발로 변경됨 |
| **표준편차** | $8.16$ | $5.0$ | 데이터 간 격차(대비)가 스타일 벡터가 의도한 최적값으로 재구성됨 |
| **시각적 결과** | 검은색, 무표정 | 밝은 금발, 부드러운 톤 | 구조(형태)는 유지하되 스타일 속성만 완전히 교체됨 |

## **4\. 주요 속성별 적용 원리 요약**

AdaIN은 각 레이어와 채널마다 다르게 작용하여 다양한 시각적 효과를 만들어냅니다.

1. **색상 및 톤 (금발 등):**  
   * $y\_b$(Bias) 값을 높게 설정하여 픽셀의 절대적인 밝기를 특정 색상 영역으로 밀어 올립니다.  
2. **질감 및 대비 (머릿결, 피부 등):**  
   * $y\_s$(Scale) 값을 조절하여 픽셀 간의 차이를 벌리거나 좁힘으로써 거친 질감 혹은 부드러운 질감을 표현합니다.  
3. **형태적 스타일 (미소, 얼굴형 등):**  
   * 초기 레이어(저해상도)의 특징 맵에서 특정 위치의 $y\_b$ 값을 조정하여 입꼬리 영역의 픽셀들을 활성화(위로 이동)시킴으로써 웃는 표정을 유도합니다.

## **5\. 핵심 결론: "지우고 다시 쓰기"**

AdaIN의 가장 강력한 점은 \*\*분리(Disentanglement)\*\*입니다.

* \*\*나눗셈($\\div \\sigma$)\*\*을 통해 입력 이미지의 기존 스타일(밝기, 대비)을 완전히 무효화합니다.  
* \*\*곱셈($\\times y\_s$)과 덧셈($+ y\_b$)\*\*을 통해 사용자가 원하는 새로운 통계적 특성을 주입합니다.

이 과정을 통해 StyleGAN은 이미지의 고유한 구조(얼굴의 각도, 눈코입의 위치)를 유지하면서도 머리색, 성별, 나이와 같은 스타일 요소를 독립적으로 제어할 수 있게 됩니다.